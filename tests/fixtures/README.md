# Test Fixtures

Synthetic test data for Portolan CLI. All fixtures are deterministic and generated by `generate.py`.

## Regenerating Fixtures

```bash
uv run python tests/fixtures/generate.py
```

## Directory Structure

```
fixtures/
├── vector/
│   ├── valid/           # Valid vector formats
│   │   ├── points.geojson       # 10 point features (San Francisco area)
│   │   ├── polygons.geojson     # 5 polygon features (neighborhoods)
│   │   ├── lines.geojson        # 5 linestring features (streets)
│   │   ├── multigeom.geojson    # Mixed geometry types
│   │   ├── large_properties.geojson  # 20+ property columns
│   │   └── points.parquet       # Pre-converted GeoParquet
│   └── invalid/         # Invalid inputs for error handling tests
│       ├── no_geometry.json     # Valid JSON, missing geometry
│       ├── malformed.geojson    # Truncated JSON
│       ├── empty.geojson        # Empty FeatureCollection
│       └── null_geometries.geojson  # Features with null geometry
├── raster/
│   ├── valid/           # Valid COG files
│   │   ├── rgb.tif              # 3-band 64x64 RGB
│   │   ├── singleband.tif       # 1-band 64x64 elevation
│   │   ├── float32.tif          # Float data type
│   │   └── nodata.tif           # Has NoData value set
│   └── invalid/         # Invalid inputs for error handling tests
│       ├── not_georeferenced.tif  # Regular TIFF, no CRS
│       └── truncated.tif          # Corrupted file
└── edge/                # Edge cases
    ├── unicode_properties.geojson    # Non-ASCII property names/values
    ├── special_filename spaces.geojson  # Spaces in filename
    └── antimeridian.geojson          # Crosses date line
```

## Fixture Details

### Vector Fixtures

All vector fixtures use:
- **CRS:** WGS84 (EPSG:4326)
- **Location:** San Francisco Bay Area (roughly -122.5 to -122.3, 37.7 to 37.85)
- **Properties:** Mix of string, integer, float, boolean, and null values

| File | Features | Geometry | Purpose |
|------|----------|----------|---------|
| `points.geojson` | 10 | Point | Basic point handling |
| `polygons.geojson` | 5 | Polygon | Polygon area/centroid tests |
| `lines.geojson` | 5 | LineString | Line length tests |
| `multigeom.geojson` | 6 | Mixed | Geometry type detection |
| `large_properties.geojson` | 5 | Point | Schema extraction breadth |
| `points.parquet` | 10 | Point | Pre-converted format handling |

### Raster Fixtures

All raster fixtures use:
- **CRS:** WGS84 (EPSG:4326)
- **Size:** 64x64 pixels
- **Bounds:** San Francisco area
- **Format:** Cloud-Optimized GeoTIFF (COG)

| File | Bands | Data Type | Purpose |
|------|-------|-----------|---------|
| `rgb.tif` | 3 | uint8 | Basic RGB handling |
| `singleband.tif` | 1 | uint8 | Single-band classification |
| `float32.tif` | 1 | float32 | Continuous data (elevation) |
| `nodata.tif` | 1 | uint8 | NoData value preservation |

### Invalid Fixtures

Each invalid fixture tests a specific failure mode:

| File | Issue | Expected Behavior |
|------|-------|-------------------|
| `no_geometry.json` | No geometry field | Error: "No geometry column found" |
| `malformed.geojson` | Truncated JSON | Error: JSON parse error |
| `empty.geojson` | Zero features | Warning or error depending on context |
| `null_geometries.geojson` | Null in geometry | Error or skip depending on context |
| `not_georeferenced.tif` | No CRS metadata | Error: "Missing CRS" |
| `truncated.tif` | File cut off | Error: Corrupted file |

### Edge Cases

| File | Edge Case | Purpose |
|------|-----------|---------|
| `unicode_properties.geojson` | Non-ASCII characters | Encoding handling |
| `special_filename spaces.geojson` | Spaces in name | Path escaping |
| `antimeridian.geojson` | Crosses +-180 longitude | Bbox computation |

## Adding New Fixtures

1. Add generation logic to `generate.py`
2. Update this README
3. Run `uv run python tests/fixtures/generate.py`
4. Commit the fixture files

## GeoPackage Note

GeoPackage fixtures are deferred to issue #30 (real-world data). Synthetic fixtures cover GeoJSON and GeoParquet only.
